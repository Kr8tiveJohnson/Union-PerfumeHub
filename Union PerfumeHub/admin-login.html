<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel | Perfume Hub</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="dashboard">

<!-- SIDEBAR -->
<aside class="sidebar">
  <h2 class="sidebar-logo">Admin</h2>
  <nav>
    <a class="active">Dashboard</a>
    <a onclick="adminLogout()">Logout</a>
  </nav>
</aside>

<!-- MAIN -->
<main class="dashboard-main fade-in">

<header class="dashboard-header">
  <h1>Perfume Hub Admin</h1>
  <p>Platform overview</p>
</header>

<!-- STATS -->
<section class="stats">
  <div class="stat-card">
    <h3 id="vendorCount">0</h3>
    <span>Vendors</span>
  </div>
  <div class="stat-card">
    <h3 id="productCount">0</h3>
    <span>Products</span>
  </div>
</section>

<!-- VENDORS -->
<section class="admin-section">
  <h2>Vendors</h2>
  <div id="vendorList" class="admin-list"></div>
</section>

<!-- PRODUCTS -->
<section class="admin-section">
  <h2>Products</h2>
  <div id="productList" class="admin-list"></div>
</section>

</main>
</div>

<script>
// SIMPLE ADMIN LOGIN CHECK
let isAdmin = localStorage.getItem("adminLogged");

if(!isAdmin){
  let pass = prompt("Enter admin password");
  if(pass !== "admin123"){
    alert("Access denied");
    location.href="index.html";
  } else {
    localStorage.setItem("adminLogged", true);
  }
}

// LOAD DATA
let vendors = JSON.parse(localStorage.getItem("vendors")) || [];
let products = JSON.parse(localStorage.getItem("products")) || [];

document.getElementById("vendorCount").textContent = vendors.length;
document.getElementById("productCount").textContent = products.length;

// RENDER VENDORS
let vendorList = document.getElementById("vendorList");

if(vendors.length === 0){
  vendorList.innerHTML = "<p class='empty-text'>No vendors yet.</p>";
}

vendors.forEach(v => {

  let vendorProducts = products.filter(p => p.vendorName === v.business);

  vendorList.innerHTML += `
    <div class="admin-card">
      <strong>${v.business}</strong>
      <span>Email: ${v.email}</span>
      <small>Products: ${vendorProducts.length}</small>

      <div class="admin-vendor-products">
        ${vendorProducts.map(p => `
          <div class="admin-product-row">
            <img src="${p.image}">
            <span>${p.name} – ₦${p.price}</span>
            <button onclick="adminDeleteProduct(${p.id})">Delete</button>
        </div>

        `).join("")}
      </div>
    </div>
  `;
});

function adminDeleteProduct(id){
  if(!confirm("Admin: Delete this product permanently?")) return;

  let products = JSON.parse(localStorage.getItem("products")) || [];
  products = products.filter(p => p.id !== id);

  localStorage.setItem("products", JSON.stringify(products));
  location.reload();
}

// RENDER PRODUCTS
let productList = document.getElementById("productList");

if(products.length === 0){
  productList.innerHTML = "<p class='empty-text'>No products yet.</p>";
}

products.forEach(p => {
  productList.innerHTML += `
    <div class="admin-card">
      <strong>${p.name}</strong>
      <span>₦${p.price}</span>
      <small>Vendor: ${p.vendorName}</small>
    </div>
  `;
});

// LOGOUT
function adminLogout(){
  localStorage.removeItem("adminLogged");
  location.href="index.html";
}
</script>

</body>
</html>
